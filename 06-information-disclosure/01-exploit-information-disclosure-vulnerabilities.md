Table of contents
---
[toc]
# How to find and exploit information disclosure vulnerabilities

Common sources of information disclosure:

- Files for web crawlers
- Directory listings
- Developer comments 
- Error messages 
- Debugging data 
- User account pages 
- Backup files 
- Insecure configuration 
- Version control history 

## Lab #1: Information disclosure in error messages


![1f16be2cdd06fb0da0de8026aae2e924.png](_resources/94ae703aed604fdd972ec31a0f568909.png)

Application version leak:  

`Apache Struts 2 2.3.31`

It has a public exploit 

![e5a5948ed8823ff8b3d6692091e3970d.png](_resources/404c10ca87654cfc8dcbda1bdf435384.png)


## Lab #2: Information disclosure on debug page

Leaked hidden directory in html comment.

![a0e6c8740d087638f38c7695f050c2aa.png](_resources/ea78e765c04a451b86ed4d57f3c0fbfa.png)

PHP version 
![ea402ddc7f3aff01adc579be94d2329e.png](_resources/0b0fe9d447914161a34302529b23f11d.png)

PHP Environment 
![ea995f0e3a1a59ad59f08927333545c8.png](_resources/fd55670408184abfb733c75a5e3a7467.png)


## Lab #3: Source code disclosure via backup files

Discovered a hidden directory called backup in `robots.txt` file

```
https://ac521f681f06832780d52e5e00130030.web-security-academy.net/robots.txt
```

![9c1d2d7becfeec53483a378a423300a9.png](_resources/152b63654bbc49eb9eaee5cfc6a40cd1.png)

Leaked DSN

![a2978def03b9fd9daf619f927d9927be.png](_resources/3ac0057cab3d40269975ce22590ff7be.png)


## Lab #4: Authentication bypass via information disclosure

Request to admin page
![f8e983da4bb10e67dc95cc13df27046b.png](_resources/0535fb2c62044bcaad10a019995ba1b9.png)

Send TRACE request to admin
![95f0b0afd83afd65612dfa8a1b9257e1.png](_resources/b6256c067b764f7eb7c6834be780e4e9.png)


It reveals a headers (`X-Custom-IP-Authorization`) to determine if it's a local request or not

![19c0f240f6dd5197dd2cabc249c8fb38.png](_resources/8cf6ab5ef106449a85eef49787c73316.png)

![6cc1ff3f8ec83cda70cb2a3a51759484.png](_resources/3ee2021ca8514b4eb7b1888c785a3e22.png)

## Lab #5: Information disclosure in version control history

![0255dcbd98797e6ace2573f5280be8ab.png](_resources/f2b74cc632c343789b183fd949d1f48c.png)

We could access git logs on `.git/logs/HEAD`

```
 <omitted> Carlos Montoya <carlos@evil-user.net> 1613992012 +0000	commit (initial): Add skeleton admin panel
 <omitted> Carlos Montoya <carlos@evil-user.net> 1613992012 +0000	commit: Remove admin password from config
```

Bulk download with `wget`

![14a1f51717a01741a4297477fca52481.png](_resources/eec0f3e64aa3477480444d05fa56628a.png)

Checkout the earlier commit to restore admin.conf
![ec393cc9a6ae87deea58c1b0130b10c5.png](_resources/76f4507bb5e84c41bfa036fdbf6bd591.png)

![f4e78c3b745985a56113a60a472bca73.png](_resources/f90749668ff746878a2a3859893af6c3.png)
